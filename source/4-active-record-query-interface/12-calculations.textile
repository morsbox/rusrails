h1. Вычисления

Этот раздел использует count для примера из "преамбулы":/active-record-query-interface, но описанные опции применяются ко всем подразделам.

Все методы вычисления работают прямо на модели:

<ruby>
Client.count
# SELECT count(*) AS count_all FROM clients
</ruby>

Или на relation:

<ruby>
Client.where(:first_name => 'Ryan').count
# SELECT count(*) AS count_all FROM clients WHERE (first_name = 'Ryan')
</ruby>

Можете также использовать различные методы поиска на relation для выполнения сложных вычислений:

<ruby>
Client.includes("orders").where(:first_name => 'Ryan', :orders => {:status => 'received'}).count
</ruby>

Что выполнит:

<sql>
SELECT count(DISTINCT clients.id) AS count_all FROM clients
  LEFT OUTER JOIN orders ON orders.client_id = client.id WHERE
  (clients.first_name = 'Ryan' AND orders.status = 'received')
</sql>

h4. Количество

Если хотите увидеть, сколько записей есть в таблице модели, можете вызвать +Client.count+, и он возвратит число. Если хотите быть более определенным и найти всех клиентов с присутствующим в базе данных возрастом, используйте +Client.count(:age)+.

Про опции смотрите выше "Вычисления":.

h4. Среднее

Если хотите увидеть среднее значение опредененного показателя в одной из ваших таблиц, можно вызвать метод +average+ для класса, относящегося к таблице. Вызов этого метода выглядит так:

<ruby>
Client.average("orders_count")
</ruby>

Это возвратит число (возможно, с плавающей запятой, такое как 3.14159265), представляющее среднее значение поля.
Про опции смотрите выше "Вычисления":.

h4. Минимум

Если хотите найти минимальное значение поля в таблице, можете вызвать метод +minimum+ для класса, относящегося к таблице. Вызов этого метода выглядит так:

<ruby>
Client.minimum("age")
</ruby>

Про опции смотрите выше "Вычисления":.

h4. Максимум

Если хотите найти максимальное значение поля в таблице, можете вызвать метод +maximum+ для класса, относящегося к таблице. Вызов этого метода выглядит так:

<ruby>
Client.maximum("age")
</ruby>

Про опции смотрите выше "Вычисления":.

h4. Сумма

Если хотите найти сумму полей для всех записей в таблице, можете вызвать метод +sum+ для класса, относящегося к таблице. Вызов этого метода выглядит так:

<ruby>
Client.sum("orders_count")
</ruby>

Про опции смотрите выше "Вычисления":.
