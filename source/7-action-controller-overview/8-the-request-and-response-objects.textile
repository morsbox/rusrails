h1. Объекты Request и Response

В каждом контроллере есть два accessor-метода, указывающих на объекты запроса и отклика, связанные с циклом запроса, находящегося в текущее время на исполнении. Метод +request+ содержит экземпляр +AbstractRequest+, а метод +response+ возвращает объект отклика, представляющий то, что собирается быть отправлено обратно на клиента.

h4. Объект +request+

Объект request содержит множество полезной информации о запросе, полученном с клиента. Чтобы получить полный перечень доступных методов, обратитесь к "документации по API":http://api.rubyonrails.org/classes/ActionDispatch/Request.html. В числе свойств, доступных для этого объекта, следующие:

|_.Свойство +request+|_.Цель|
|host|Имя хоста, используемого для этого запроса.|
|domain(n=2)|Первые +n+ сегментов имени хоста, начиная справа (домен верхнего уровня).|
|format|Тип содержимого, запрошенного с клиента.|
|method|Метод HTTP, использованного для запроса.|
|get?, post?, put?, delete?, head?|Возвращает true, если метод HTTP - это GET/POST/PUT/DELETE/HEAD.|
|headers|Возвращает хэш, содержащий заголовки, связанные с запросом.|
|port|Номер порта (число), использованного для запроса.|
|protocol|Возвращает строку, содержащую использованный протокол плюс "://", например "http://".|
|query_string|Часть URL со строкой запроса, т.е. все после "?".|
|remote_ip|Адрес IP клиента.|
|url|Полный URL, использованный для запроса.|

h5. +path_parameters+, +query_parameters+ и +request_parameters+

Rails собирает все параметры, посланные вместе с запросом, в хэше +params+, были ли они посланы как часть строки запроса, либо в теле запроса post. У объекта request имеется три метода доступа, которые дают доступ к этим параметрам в зависимости от того, откуда они пришли. Хэш +query_parameters+ содержит параметры, посланные как часть строки запроса, а хэш +request_parameters+ содержит параметры, посланные как часть тела post. Хэш +path_parameters+ содержит параметры, распознанные роутингом как часть пути, ведущего к определенному контроллеру и экшну.

h4. Объект +response+

Объект response обычно не используется напрямую, но он создается в течение исполнения экшна и рендеринга данных, которые посылаются обратно пользователю, но иногда - например, в последующем фильтре - бывает полезно иметь доступ к отклику напрямую. Некоторые из этих методов доступа имеют настройки, позволяющие изменять их значения.

|_.Свойство +response+|_.Назначение|
|body|Это строка данных, которая будет возвращена клиенту. Часто это HTML.|
|status|Код статуса HTTP для отклика, например 200 для успешного отклика или 404 для ненайденного файла.|
|location|URL, по которому клиент будет перенаправлен, если указан.|
|content_type|Тип содержимого отклика.|
|charset|Кодировка, используемая для отклика. По умолчанию это "utf-8".|
|headers|Заголовки, используемые для отклика.|

h5. Установка пользовательских заголовков

Если хотите установить произвольные заголовки для отклика, то +response.headers+ - как раз то место, что нужно. Атрибут заголовков - это хэш, который связывает имена заголовков с их значениями, и Rails устанавливает некоторые из них автоматически. Если хотите добавить или изменить заголовок, назначьте его +response.headers+ следующим образом:

<ruby>
response.headers["Content-Type"] = "application/pdf"
</ruby>
